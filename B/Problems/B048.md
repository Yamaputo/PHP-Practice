B048:理想のビンゴ
-----------

制限時間カウント

あなたはビンゴ大会に参加しています。大会は以下の流れで進んでいきます。

  

1\. 参加者には N マス × N マスのビンゴカードが配られます。ビンゴカードのそれぞれのマスには 1 から N × N までの相異なる整数が書かれています。  
2\. 主催者が 1 から N × N までのいずれかの整数を M 回呼び上げます。毎回の呼び上げでは異なる整数が呼び上げられます。参加者は、呼び上げの度に、自分のビンゴカード上で呼び上げられた整数があるマスに穴を開けます。  
3\. M 回の呼び上げが終わった後に、その時点でビンゴカードのビンゴ数が最も多い参加者が大会の優勝者になります。ここで、ビンゴ数とは、ビンゴカード上で次の条件を満たす行・列・対角線の個数のことを指します。  
　・条件 : その行(もしくは列・対角線)のすべてのマスが開いている。

  

以下の図 (a) は N = 5 のときのビンゴカードの例です。一番下の行のすべてのマスに穴が開いていて、他にそのような行・列・対角線は無いため、このビンゴカードのビンゴ数は 1 です。

![図1](image/b048_img1.png)

ビンゴ大会は順調に進んでいき、既に主催者によって M - 1 回の整数の呼び上げが行われました。最後に呼び上げられる整数が何であるかによって、  
あなたのビンゴカードのビンゴ数は確定します。

あなたはできるだけ自分のビンゴカードのビンゴ数を多くしたいと思っています。

あなたのビンゴカードと、主催者によって呼び上げられた M - 1 個の整数が与えられます。最後の整数が自分の思い通りに呼び上げられたとしたとき、そのときのビンゴ数の最大値を答えてください。

例)  
入力例 1 において、 M - 1 回整数が呼び上げられた時点のビンゴカードが図 (a) のものだったとします。このとき、最後に呼び上げられた整数が 1 だとすると、一番上の行のすべてのマスに穴が開いたことになるため、ビンゴ数は 2 になります。しかし、最後に呼び上げられた整数が 16 だとすると、左から三番目の列のすべてのマス、および右上から左下の対角線のすべてのマスに穴が開いたことになるため、ビンゴ数は 3 となります。このビンゴカードではビンゴ数を 3 より大きくすることが出来ないため、答えは 3 となります。

![図1](image/b048_img2.png)

評価ポイント

10回のテストケースで、正答率、実行速度、メモリ消費量をはかり得点が決まります。  
より早い回答時間で提出したほうが得点が高くなります。

1.  複数のテストケースで正しい出力がされるか評価（+50点）
2.  解答までの速さ評価（+50点）

入力される値

入力は以下のフォーマットで与えられます。

    N M
    b_{1, 1} b_{1, 2} ... b_{1, N}
    b_{2, 1} b_{2, 2} ... b_{2, N}
    ...
    b_{N, 1} b_{N, 2} ... b_{N, N}
    a_1
    a_2
    ...
    a_{M-1}

*   ・1 行目にビンゴカードの縦・横のサイズを表す整数 N と、主催者が数字を呼び上げる回数 M がこの順で半角スペース区切りで与えられます。
*   ・続く N 行のうちの i 行目 (1 ≦ i ≦ N) には N 個の整数が半角スペース区切りで与えられます。i 行目の j 番目 (1 ≦ j ≦ N) の整数 b\_{i, j} は、あなたのビンゴカードの i 行 j 列目に書かれている整数を表します。
*   ・続く M - 1 行のうちの k 行目 (1 ≦ k ≦ M - 1) には、主催者によって k 番目に呼び上げられた整数 a\_k が与えられます。
*   ・入力は合計で N + M 行となり、入力値最終行の末尾に改行が 1 つ入ります。

  
  

期待する出力

最大のビンゴ数を整数で出力してください。

出力の最後に改行を入れ、余計な文字、空行を含んではいけません。

条件

すべてのテストケースにおいて、以下の条件をみたします。

*   ・3 ≦ N ≦ 50
*   ・1 ≦ M ≦ N × N
*   ・各 i, j (1 ≦ i ≦ N, 1 ≦ j ≦ N) について
*   　・1 ≦ b\_{i, j} ≦ N × N
*   　・b\_{i, j} はすべて相異なる。すなわち, 各 i', j' (1 ≦ i' ≦ N, 1 ≦ j' ≦ N) について i ≠ i' または j ≠ j' のとき b\_{i, j} ≠ b\_{i', j'}
*   ・各 k (1 ≦ k ≦ M - 1) について
*   　・1 ≦ a\_k ≦ N × N
*   　・a\_k はすべて相異なる。すなわち、各 k' (1 ≦ k' ≦ M - 1) について k ≠ k' のとき a\_k ≠ a\_k'

入力例1

    5 17
    1 18 4 19 14
    17 3 25 11 6
    23 12 16 2 21
    10 24 22 8 9
    5 20 7 13 15
    11
    19
    14
    15
    12
    22
    13
    23
    24
    7
    20
    5
    18
    9
    4
    25
    

出力例1

    3
    

入力例2

    6 23
    29 7 20 6 23 24
    35 26 10 19 28 11
    27 8 22 34 36 33
    2 5 32 31 21 30
    12 17 15 18 25 3
    13 1 9 4 16 14
    23 21 31 14 35 2 5 25 34 27 10 20 15 29 9 11 32 22 28 19 26 13
    

出力例2

    4