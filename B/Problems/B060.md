B060:サイコロころがし
-------------

制限時間カウント

MQくんはデザイナーです。今日、MQくんはサイコロを使って旗のデザインをしてみようと考えました。  
MQくんがデザインしようとしている旗は、H × W のマスに格子状に区切られた旗です。このマスに、次のルールに従って色を塗っていきます。

1\. 最初、すべてのマスを白に塗る。  
2\. 次に、sy 行 sx 列目にサイコロを置く。  
  
サイコロの展開図は下図の様になっていて、最初は 1 の目が上を向いている。サイコロを正面から見ると、 **5 の目が書かれている配置**になっている。5 の目の右隣は **4 の目**になっている。  

![図1](image/b060_img1.png)

3\. サイコロを N 回転がす。転がす方向は上下左右のいずれかであり、どの場合もそれぞれの方向にサイコロを 90 度回転する。

上記の手順に従って、入力例 1 の最初の 2 回の回転を図に表すと、以下のようになります。

![図1](image/b060_img2.png)

この操作だけではマス目には何も色が塗られないように見えます。しかし、パイザくんは、予めサイコロの各面にペンキを塗っていたので、サイコロの下を向いている目の色が、そこに接しているマスに塗られます。

ここで、すでに着色されているマスにサイコロが再び置かれた場合、**そのマスの色は上書きされます**。

パイザくんはこの操作によってどのような盤面ができるのかが気になりました。そこで、パイザくんのために、

・ 白色を 0  
・ 1 の目に塗られた色を 1  
・ 2 の目に塗られた色を 2  
・ ...  
・ 6 の目に塗られた色を 6

として、パイザくんが考える手順をシミュレーションしたあとの旗を出力するプログラムを作ってください。

評価ポイント

10回のテストケースで、正答率、実行速度、メモリ消費量をはかり得点が決まります。  
より早い回答時間で提出したほうが得点が高くなります。

1.  複数のテストケースで正しい出力がされるか評価（+50点）
2.  解答までの速さ評価（+50点）

入力される値

入力は以下のフォーマットで与えられます。

    N H W
    sy sx
    s

*   ・1 行目に、回転する回数を表す整数 N、マス目の縦の大きさを表す整数 H、マス目の横の大きさを表す整数 W がこの順で半角スペース区切りで与えられます。
*   ・2 行目に、最初にサイコロを置く行を表す整数 sy と最初にサイコロを置く列を表す整数 sx がこの順で半角スペース区切りで与えられます。
*   ・3 行目に、移動方法を表す N 文字の文字列 s が与えられます。 s の i 文字目 (1 ≦ i ≦ N) は、上方向である場合 "U"、下方向である場合 "D"、左方向である場合 "L"、右方向である場合 "R" となります。
*   ・入力は合計で 3 行となり、入力値最終行の末尾に改行が 1 つ入ります。

  

期待する出力

パイザくんが考える手順をシミュレーションしたあとの旗を、以下の形式で出力してください。

    a_{1,1} a_{1,2} ... a_{1,W}
    a_{2,1} a_{2,2} ... a_{2,W}
    ...
    a_{H,1} a_{H,2} ... a_{H,W}

・期待する出力は H 行からなります。  
・i 行目 (1 ≦ i ≦ H) には W 個の数字を半角スペース区切りで出力してください。i 行目の j 番目 (1 ≦ j ≦ W) の数字 a\_{i, j} は、旗の i 行 j 列目にかかれている数字を表します。  
・H 行目の出力の最後に改行を入れ、余計な文字、空行を含んではいけません。

条件

すべてのテストケースにおいて、以下の条件をみたします。

*   ・0 ≦ N ≦ 1,000
*   ・1 ≦ H, W ≦ 100
*   ・1 ≦ sy ≦ H
*   ・1 ≦ sx ≦ W
*   ・文字列 s の i 文字目 (1 ≦ i ≦ N) は "U", "D", "L", "R" のいずれか
*   ・サイコロを旗の外に転がすことはない

入力例1

    7 3 4
    2 1
    DRRUULL
    

出力例1

    2 4 5 0
    6 0 6 0
    5 4 2 0
    

入力例2

    19 9 3
    1 1
    DDDDDDDDRUUUUUUUURD
    

出力例2

    6 4 1
    5 5 5
    1 3 0
    2 2 0
    6 4 0
    5 5 0
    1 3 0
    2 2 0
    6 4 0
    

入力例3

    5 3 3
    2 2
    RULDL
    

出力例3

    0 6 2
    5 4 4
    0 0 0
    

入力例4

    40 7 9
    6 5
    RRDRRLLRRUDLRULRDLUDURULDLULUUUUDDDURRLR
    

出力例4

    0 0 0 0 0 5 0 0 0
    0 0 0 0 0 3 0 0 0
    0 0 0 0 0 2 1 5 0
    0 0 0 0 0 4 0 0 0
    0 0 0 0 0 5 1 1 4
    0 0 0 0 6 4 3 2 2
    0 0 0 0 0 0 5 3 2